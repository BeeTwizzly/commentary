/*
 * Portfolio Commentary Generator — Streamlit CSS Polish
 *
 * Usage: Inject via st.markdown('<style>...</style>', unsafe_allow_html=True)
 * or save as .streamlit/style.css and load at app startup.
 *
 * This smooths rough edges without breaking Streamlit's layout engine.
 * Tested against Streamlit 1.3x component class names.
 */

/* ═══════════════════════════════════════════════════════
 1. GLOBAL FOUNDATIONS
 ═══════════════════════════════════════════════════════ */

@import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300..700;1,9..40,300..700&family=IBM+Plex+Mono:wght@400;500&display=swap');

:root {
 --pcg-bg-primary: #0f1117;
 --pcg-bg-secondary: #1a1d27;
 --pcg-bg-card: #1e2130;
 --pcg-bg-card-hover: #252839;
 --pcg-border: #2a2d3a;
 --pcg-border-subtle: #22252f;
 --pcg-text-primary: #e8eaed;
 --pcg-text-secondary: #9aa0b0;
 --pcg-text-muted: #6b7280;
 --pcg-accent: #4f8ff7;
 --pcg-accent-hover: #6ba0ff;
 --pcg-accent-subtle: rgba(79, 143, 247, 0.12);
 --pcg-success: #34d399;
 --pcg-success-subtle: rgba(52, 211, 153, 0.1);
 --pcg-warning: #fbbf24;
 --pcg-danger: #f87171;
 --pcg-radius-sm: 6px;
 --pcg-radius-md: 10px;
 --pcg-radius-lg: 14px;
 --pcg-shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
 --pcg-shadow-md: 0 4px 12px rgba(0,0,0,0.4);
 --pcg-transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Force dark mode across the app */
.stApp, [data-testid="stAppViewContainer"] {
 background-color: var(--pcg-bg-primary) !important;
 color: var(--pcg-text-primary) !important;
 font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif !important;
}

/* Smooth rendering */
* {
 -webkit-font-smoothing: antialiased;
 -moz-osx-font-smoothing: grayscale;
}


/* ═══════════════════════════════════════════════════════
 2. SIDEBAR POLISH
 ═══════════════════════════════════════════════════════ */

[data-testid="stSidebar"] {
 background: linear-gradient(180deg, #141620 0%, #0f1117 100%) !important;
 border-right: 1px solid var(--pcg-border) !important;
 padding-top: 1rem !important;
}

[data-testid="stSidebar"] [data-testid="stMarkdown"] h1,
[data-testid="stSidebar"] [data-testid="stMarkdown"] h2,
[data-testid="stSidebar"] [data-testid="stMarkdown"] h3 {
 color: var(--pcg-text-primary) !important;
 font-weight: 600 !important;
 letter-spacing: -0.01em;
}

[data-testid="stSidebar"] [data-testid="stMarkdown"] p,
[data-testid="stSidebar"] [data-testid="stMarkdown"] span,
[data-testid="stSidebar"] label {
 color: var(--pcg-text-secondary) !important;
 font-size: 0.85rem !important;
}

/* Sidebar section dividers */
[data-testid="stSidebar"] hr {
 border-color: var(--pcg-border) !important;
 margin: 1rem 0 !important;
}

/* Navigation buttons (Upload / Review) */
[data-testid="stSidebar"] button[kind="secondary"],
[data-testid="stSidebar"] .stButton > button {
 background: var(--pcg-bg-card) !important;
 color: var(--pcg-text-primary) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
 font-family: 'DM Sans', sans-serif !important;
 font-weight: 500 !important;
 font-size: 0.85rem !important;
 padding: 0.5rem 1rem !important;
 transition: all var(--pcg-transition) !important;
}

[data-testid="stSidebar"] .stButton > button:hover {
 background: var(--pcg-bg-card-hover) !important;
 border-color: var(--pcg-accent) !important;
 color: var(--pcg-accent) !important;
}

/* Active nav button */
[data-testid="stSidebar"] button[kind="primary"],
[data-testid="stSidebar"] .stButton > button[kind="primary"] {
 background: var(--pcg-accent) !important;
 color: #fff !important;
 border: none !important;
 font-weight: 600 !important;
}

/* Sidebar slider (Variations per holding) */
[data-testid="stSidebar"] .stSlider [data-testid="stThumbValue"] {
 color: var(--pcg-accent) !important;
 font-family: 'IBM Plex Mono', monospace !important;
 font-weight: 500 !important;
}

[data-testid="stSidebar"] .stSlider [role="slider"] {
 background-color: var(--pcg-accent) !important;
}

/* Resource badges in sidebar */
[data-testid="stSidebar"] .stAlert {
 background: var(--pcg-accent-subtle) !important;
 border: 1px solid rgba(79, 143, 247, 0.2) !important;
 border-radius: var(--pcg-radius-md) !important;
 color: var(--pcg-accent) !important;
 font-size: 0.8rem !important;
 padding: 0.5rem 0.75rem !important;
}

/* Session cost in sidebar */
[data-testid="stSidebar"] [data-testid="stMetric"] {
 background: var(--pcg-bg-card) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
 padding: 0.75rem !important;
}

[data-testid="stSidebar"] [data-testid="stMetricValue"] {
 color: var(--pcg-success) !important;
 font-family: 'IBM Plex Mono', monospace !important;
 font-size: 1.4rem !important;
}


/* ═══════════════════════════════════════════════════════
 3. MAIN CONTENT AREA
 ═══════════════════════════════════════════════════════ */

/* Page titles */
[data-testid="stAppViewContainer"] h1 {
 color: var(--pcg-text-primary) !important;
 font-weight: 700 !important;
 font-size: 1.75rem !important;
 letter-spacing: -0.025em;
 margin-bottom: 0.25rem !important;
}

[data-testid="stAppViewContainer"] h2 {
 color: var(--pcg-text-primary) !important;
 font-weight: 600 !important;
 font-size: 1.3rem !important;
 letter-spacing: -0.02em;
}

[data-testid="stAppViewContainer"] h3 {
 color: var(--pcg-text-secondary) !important;
 font-weight: 500 !important;
 font-size: 1.05rem !important;
}

/* Subtitle / description text */
[data-testid="stAppViewContainer"] p {
 color: var(--pcg-text-secondary) !important;
 line-height: 1.6;
}


/* ═══════════════════════════════════════════════════════
 4. FILE UPLOADER
 ═══════════════════════════════════════════════════════ */

[data-testid="stFileUploader"] {
 background: var(--pcg-bg-card) !important;
 border: 2px dashed var(--pcg-border) !important;
 border-radius: var(--pcg-radius-lg) !important;
 padding: 1.5rem !important;
 transition: all var(--pcg-transition) !important;
}

[data-testid="stFileUploader"]:hover {
 border-color: var(--pcg-accent) !important;
 background: var(--pcg-accent-subtle) !important;
}

[data-testid="stFileUploader"] p,
[data-testid="stFileUploader"] span,
[data-testid="stFileUploader"] small {
 color: var(--pcg-text-secondary) !important;
}

/* Uploaded file indicator */
[data-testid="stFileUploader"] [data-testid="stFileUploaderFile"] {
 background: var(--pcg-bg-secondary) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-sm) !important;
}


/* ═══════════════════════════════════════════════════════
 5. STRATEGY MULTISELECT
 ═══════════════════════════════════════════════════════ */

[data-testid="stMultiSelect"] > div {
 background: var(--pcg-bg-card) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
}

/* Selected strategy chips/tags */
[data-testid="stMultiSelect"] [data-baseweb="tag"] {
 background: var(--pcg-accent) !important;
 color: #fff !important;
 border-radius: var(--pcg-radius-sm) !important;
 font-weight: 500 !important;
 font-size: 0.8rem !important;
}


/* ═══════════════════════════════════════════════════════
 6. PRIMARY ACTION BUTTON (Generate)
 ═══════════════════════════════════════════════════════ */

[data-testid="stAppViewContainer"] .stButton > button[kind="primary"],
[data-testid="stAppViewContainer"] button.st-emotion-cache-1gulkj5 {
 background: linear-gradient(135deg, var(--pcg-accent) 0%, #3a6fd8 100%) !important;
 color: #fff !important;
 border: none !important;
 border-radius: var(--pcg-radius-md) !important;
 font-family: 'DM Sans', sans-serif !important;
 font-weight: 600 !important;
 font-size: 0.95rem !important;
 padding: 0.7rem 1.5rem !important;
 letter-spacing: 0.01em;
 box-shadow: 0 2px 8px rgba(79, 143, 247, 0.3) !important;
 transition: all var(--pcg-transition) !important;
 width: 100%;
}

[data-testid="stAppViewContainer"] .stButton > button[kind="primary"]:hover {
 box-shadow: 0 4px 16px rgba(79, 143, 247, 0.45) !important;
 transform: translateY(-1px);
}


/* ═══════════════════════════════════════════════════════
 7. VARIATION TABS (Critical UX improvement)
 ═══════════════════════════════════════════════════════ */

/* Make tabs more prominent and easier to scan */
.stTabs [data-baseweb="tab-list"] {
 gap: 0 !important;
 background: var(--pcg-bg-secondary) !important;
 border-radius: var(--pcg-radius-md) !important;
 padding: 3px !important;
 border: 1px solid var(--pcg-border) !important;
}

.stTabs [data-baseweb="tab"] {
 background: transparent !important;
 color: var(--pcg-text-muted) !important;
 border-radius: var(--pcg-radius-sm) !important;
 font-family: 'DM Sans', sans-serif !important;
 font-weight: 500 !important;
 font-size: 0.85rem !important;
 padding: 0.45rem 1rem !important;
 transition: all var(--pcg-transition) !important;
 border: none !important;
}

.stTabs [data-baseweb="tab"]:hover {
 color: var(--pcg-text-primary) !important;
 background: var(--pcg-bg-card) !important;
}

/* Active tab */
.stTabs [aria-selected="true"] {
 background: var(--pcg-accent) !important;
 color: #fff !important;
 font-weight: 600 !important;
 box-shadow: 0 1px 4px rgba(79, 143, 247, 0.3) !important;
}

/* Remove default tab underline */
.stTabs [data-baseweb="tab-highlight"] {
 display: none !important;
}

/* Tab content panel */
.stTabs [data-baseweb="tab-panel"] {
 padding-top: 1rem !important;
}


/* ═══════════════════════════════════════════════════════
 8. HOLDING CARDS / EXPANDERS
 ═══════════════════════════════════════════════════════ */

/* Style expanders as proper cards */
[data-testid="stExpander"] {
 background: var(--pcg-bg-card) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-lg) !important;
 margin-bottom: 0.75rem !important;
 overflow: hidden;
 transition: all var(--pcg-transition) !important;
}

[data-testid="stExpander"]:hover {
 border-color: rgba(79, 143, 247, 0.3) !important;
 box-shadow: var(--pcg-shadow-sm) !important;
}

/* Expander header */
[data-testid="stExpander"] summary,
[data-testid="stExpander"] [data-testid="stExpanderToggleDetails"] {
 color: var(--pcg-text-primary) !important;
 font-weight: 600 !important;
 font-size: 0.95rem !important;
 padding: 0.75rem 1rem !important;
}

/* Expander content area */
[data-testid="stExpander"] [data-testid="stExpanderDetails"] {
 border-top: 1px solid var(--pcg-border) !important;
 padding: 1rem !important;
}


/* ═══════════════════════════════════════════════════════
 9. TEXT AREAS (Commentary editing)
 ═══════════════════════════════════════════════════════ */

[data-testid="stTextArea"] textarea {
 background: var(--pcg-bg-secondary) !important;
 color: var(--pcg-text-primary) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
 font-family: 'DM Sans', sans-serif !important;
 font-size: 0.88rem !important;
 line-height: 1.65 !important;
 padding: 0.75rem 1rem !important;
 transition: border-color var(--pcg-transition) !important;
}

[data-testid="stTextArea"] textarea:focus {
 border-color: var(--pcg-accent) !important;
 box-shadow: 0 0 0 2px var(--pcg-accent-subtle) !important;
 outline: none !important;
}


/* ═══════════════════════════════════════════════════════
 10. STATUS BANNERS & PROGRESS
 ═══════════════════════════════════════════════════════ */

/* Success banners (e.g. "10 commentaries ready for review") */
[data-testid="stAlert"][data-baseweb-alert-kind="positive"],
.element-container .stSuccess {
 background: var(--pcg-success-subtle) !important;
 border: 1px solid rgba(52, 211, 153, 0.25) !important;
 border-radius: var(--pcg-radius-md) !important;
 color: var(--pcg-success) !important;
}

/* Info banners */
[data-testid="stAlert"][data-baseweb-alert-kind="info"],
.element-container .stInfo {
 background: var(--pcg-accent-subtle) !important;
 border: 1px solid rgba(79, 143, 247, 0.25) !important;
 border-radius: var(--pcg-radius-md) !important;
 color: var(--pcg-accent) !important;
}

/* Progress bar */
.stProgress > div > div {
 background: linear-gradient(90deg, var(--pcg-accent) 0%, var(--pcg-success) 100%) !important;
 border-radius: 99px !important;
}

.stProgress > div {
 background: var(--pcg-bg-secondary) !important;
 border-radius: 99px !important;
}


/* ═══════════════════════════════════════════════════════
 11. METRICS (Review page stats)
 ═══════════════════════════════════════════════════════ */

[data-testid="stMetric"] {
 background: var(--pcg-bg-card) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
 padding: 0.75rem 1rem !important;
}

[data-testid="stMetricLabel"] {
 color: var(--pcg-text-muted) !important;
 font-size: 0.75rem !important;
 text-transform: uppercase !important;
 letter-spacing: 0.05em !important;
}

[data-testid="stMetricValue"] {
 color: var(--pcg-text-primary) !important;
 font-family: 'IBM Plex Mono', monospace !important;
 font-weight: 600 !important;
}

[data-testid="stMetricDelta"] {
 font-family: 'IBM Plex Mono', monospace !important;
 font-size: 0.8rem !important;
}


/* ═══════════════════════════════════════════════════════
 12. SELECT BOXES & DROPDOWNS
 ═══════════════════════════════════════════════════════ */

[data-testid="stSelectbox"] > div,
[data-baseweb="select"] > div {
 background: var(--pcg-bg-card) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
 color: var(--pcg-text-primary) !important;
}

[data-baseweb="menu"] {
 background: var(--pcg-bg-card) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
}

[data-baseweb="menu"] li {
 color: var(--pcg-text-primary) !important;
}

[data-baseweb="menu"] li:hover {
 background: var(--pcg-accent-subtle) !important;
}


/* ═══════════════════════════════════════════════════════
 13. SECONDARY BUTTONS (Approve All, Reset, etc.)
 ═══════════════════════════════════════════════════════ */

[data-testid="stAppViewContainer"] .stButton > button:not([kind="primary"]) {
 background: var(--pcg-bg-card) !important;
 color: var(--pcg-text-primary) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
 font-family: 'DM Sans', sans-serif !important;
 font-weight: 500 !important;
 font-size: 0.85rem !important;
 padding: 0.5rem 1rem !important;
 transition: all var(--pcg-transition) !important;
}

[data-testid="stAppViewContainer"] .stButton > button:not([kind="primary"]):hover {
 background: var(--pcg-bg-card-hover) !important;
 border-color: var(--pcg-accent) !important;
}


/* ═══════════════════════════════════════════════════════
 14. SCROLLBAR
 ═══════════════════════════════════════════════════════ */

::-webkit-scrollbar {
 width: 6px;
 height: 6px;
}

::-webkit-scrollbar-track {
 background: var(--pcg-bg-primary);
}

::-webkit-scrollbar-thumb {
 background: var(--pcg-border);
 border-radius: 99px;
}

::-webkit-scrollbar-thumb:hover {
 background: var(--pcg-text-muted);
}


/* ═══════════════════════════════════════════════════════
 15. WORD COUNT & METADATA LABELS
 ═══════════════════════════════════════════════════════ */

[data-testid="stCaptionContainer"],
.stCaption {
 color: var(--pcg-text-muted) !important;
 font-family: 'IBM Plex Mono', monospace !important;
 font-size: 0.72rem !important;
 letter-spacing: 0.02em;
}


/* ═══════════════════════════════════════════════════════
 16. TOOLTIP / HELP ICONS
 ═══════════════════════════════════════════════════════ */

[data-testid="stTooltipIcon"] {
 color: var(--pcg-text-muted) !important;
}

[data-testid="stTooltipContent"] {
 background: var(--pcg-bg-card) !important;
 border: 1px solid var(--pcg-border) !important;
 border-radius: var(--pcg-radius-md) !important;
 color: var(--pcg-text-secondary) !important;
}


/* ═══════════════════════════════════════════════════════
 17. RESPONSIVE TWEAKS
 ═══════════════════════════════════════════════════════ */

@media (max-width: 768px) {
 [data-testid="stSidebar"] {
  min-width: 200px !important;
 }

 .stTabs [data-baseweb="tab"] {
  padding: 0.35rem 0.65rem !important;
  font-size: 0.8rem !important;
 }
}
